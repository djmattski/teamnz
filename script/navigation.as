package script {		import flash.display.*;	import flash.geom.Matrix;	import flash.events.MouseEvent;	import com.greensock.*;	import com.greensock.easing.*;		public class navigation extends MovieClip{				private var currSecName:String;		private var navAltered:Boolean;		private var my_dispatch:customDispatcher;		public var navYDelta:int;		private var teamLinkCover:MovieClip;		private var teamLink:MovieClip;		private var teamLinkTxt:teamLinkText;		private var teamLinkNumb:teamLinkNum;		private var historyLinkCover:MovieClip;		private var historyLink:MovieClip;		private var historyLinkTxt:historyLinkText;		private var historyLinkNumb:historyLinkNum;		private var boatsLinkCover:MovieClip;		private var boatsLink:MovieClip;		private var boatsLinkTxt:boatsLinkText;		private var boatsLinkNumb:boatsLinkNum;		private var sponsorsLinkCover:MovieClip;		private var sponsorsLink:MovieClip;		private var sponsorsLinkTxt:sponsorsLinkText;		private var sponsorsLinkNumb:sponsorsLinkNum;		private var pradaLinkCover:MovieClip;		private var pradaLink:MovieClip;		private var pradaLinkTxt:pradaLinkText;		private var pradaLinkNumb:pradaLinkNum;		private var sanFranLinkCover:MovieClip;		private var sanFranLink:MovieClip;		private var sanFranLinkTxt:sanFranLinkText;		private var sanFranLinkNumb:sanFranLinkNum;		private var volvoLinkCover:MovieClip;		private var volvoLink:MovieClip;		private var volvoLinkTxt:volvoLinkText;		private var volvoLinkNumb:volvoLinkNum;		private var resourcesLinkCover:MovieClip;		private var resourcesLink:MovieClip;		private var resourcesLinkTxt:resourcesLinkText;		private var resourcesLinkNumb:resourcesLinkNum;				public function navigation() {			// constructor code						navAltered = false;			navYDelta = 0;			currSecName = 'home';						/**			* Add each nav item comprised of three parts:			* 1. The visible shape that will tween			* 2. The text mc			* 3. The cover that tweens with the shape - this is used for all mouse events.			*/						//team			teamLink = new MovieClip();			teamLink.name = 'teamLink';			teamLink.x = 0;			teamLink.y = 0;			teamLink.alpha = 0;			teamLink.graphics.lineStyle(0, 0x000000, 0);			teamLink.graphics.beginFill(0xD4A630, 1);			teamLink.graphics.drawRect(0, 0, 118, 44);			teamLink.graphics.endFill();			teamLink.rotation = 8;			skewer(teamLink,-3.8,-3.8);			addChild(teamLink);						teamLinkTxt = new teamLinkText();			teamLinkTxt.name = 'teamLinkTxt';			teamLinkTxt.alpha = 0;			teamLinkTxt.x = teamLink.x - 30;			teamLinkTxt.y = teamLink.y + 65;			teamLinkTxt.mouseEnabled = false;			teamLinkTxt.visible = false;			addChild(teamLinkTxt);			teamLinkNumb = new teamLinkNum();			teamLinkNumb.name = 'teamLinkNumb';			teamLinkNumb.x = teamLink.x + teamLink.width - 46;			teamLinkNumb.y = teamLink.y + 18;			teamLinkNumb.alpha = 0;			teamLinkNumb.mouseEnabled = false;			addChild(teamLinkNumb);						teamLinkCover = new MovieClip();			teamLinkCover.name = 'team';			teamLinkCover.x = 0;			teamLinkCover.y = 0;			teamLinkCover.graphics.lineStyle(0, 0x000000, 0);			teamLinkCover.graphics.beginFill(0x788989, 1);			teamLinkCover.graphics.drawRect(0, 0, 118, 44);			teamLinkCover.graphics.endFill();			teamLinkCover.rotation = 8;			teamLinkCover.alpha = 0;			skewer(teamLinkCover,-3.8,-3.8);			teamLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			teamLinkCover.addEventListener(MouseEvent.MOUSE_DOWN,prepareSection);			addChild(teamLinkCover);									//history			historyLink = new MovieClip();			historyLink.name = 'historyLink';			historyLink.graphics.lineStyle(0, 0x000000, 0);			historyLink.graphics.beginFill(0xB33048, 1);			historyLink.graphics.drawRect(0, 0, 118, 44);			historyLink.graphics.endFill();			historyLink.rotation = 8;			historyLink.x = teamLink.x + (teamLink.width - 3);			historyLink.y = 0;			historyLink.alpha = 0;			skewer(historyLink,-3.8,-3.8);			addChild(historyLink);						historyLinkTxt = new historyLinkText();			historyLinkTxt.name = 'historyLinkTxt';			historyLinkTxt.alpha = 0;			historyLinkTxt.x = historyLink.x - 30;			historyLinkTxt.y = historyLink.y + 65;			historyLinkTxt.mouseEnabled = false;			historyLinkTxt.visible = false;			addChild(historyLinkTxt);			historyLinkNumb = new historyLinkNum();			historyLinkNumb.name = 'historyLinkNumb';			historyLinkNumb.x = historyLink.x + historyLink.width - 46;			historyLinkNumb.y = historyLink.y + 18;			historyLinkNumb.alpha = 0;			historyLinkNumb.mouseEnabled = false;			addChild(historyLinkNumb);						historyLinkCover = new MovieClip();			historyLinkCover.name = 'history';			historyLinkCover.x = teamLink.x + (teamLink.width - 3);			historyLinkCover.y = 0;			historyLinkCover.graphics.lineStyle(0, 0x000000, 0);			historyLinkCover.graphics.beginFill(0x788989, 1);			historyLinkCover.graphics.drawRect(0, 0, 118, 44);			historyLinkCover.graphics.endFill();			historyLinkCover.rotation = 8;			historyLinkCover.alpha = 0;			skewer(historyLinkCover,-3.8,-3.8);			historyLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(historyLinkCover);									//boats			boatsLink = new MovieClip();			boatsLink.name = 'boatsLink';			boatsLink.graphics.lineStyle(0, 0x000000, 0);			boatsLink.graphics.beginFill(0x0082A7, 1);			boatsLink.graphics.drawRect(0, 0, 118, 44);			boatsLink.graphics.endFill();			boatsLink.rotation = 8;			boatsLink.x = historyLink.x + (historyLink.width - 3);			boatsLink.y = 0;			boatsLink.alpha = 0;			skewer(boatsLink,-3.8,-3.8);			addChild(boatsLink);						boatsLinkTxt = new boatsLinkText();			boatsLinkTxt.name = 'boatsLinkTxt';			boatsLinkTxt.alpha = 0;			boatsLinkTxt.x = boatsLink.x - 19;			boatsLinkTxt.y = boatsLink.y + 65;			boatsLinkTxt.mouseEnabled = false;			boatsLinkTxt.visible = false;			addChild(boatsLinkTxt);			boatsLinkNumb = new boatsLinkNum();			boatsLinkNumb.name = 'boatsLinkNumb';			boatsLinkNumb.x = boatsLink.x + boatsLink.width - 46;			boatsLinkNumb.y = boatsLink.y + 18;			boatsLinkNumb.alpha = 0;			boatsLinkNumb.mouseEnabled = false;			addChild(boatsLinkNumb);						boatsLinkCover = new MovieClip();			boatsLinkCover.name = 'boats';			boatsLinkCover.x = historyLink.x + (historyLink.width - 3);			boatsLinkCover.y = 0;			boatsLinkCover.graphics.lineStyle(0, 0x000000, 0);			boatsLinkCover.graphics.beginFill(0x788989, 1);			boatsLinkCover.graphics.drawRect(0, 0, 118, 44);			boatsLinkCover.graphics.endFill();			boatsLinkCover.rotation = 8;			boatsLinkCover.alpha = 0;			skewer(boatsLinkCover,-3.8,-3.8);			boatsLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			boatsLinkCover.addEventListener(MouseEvent.MOUSE_DOWN,prepareSection);			addChild(boatsLinkCover);						//sponsors			sponsorsLink = new MovieClip();			sponsorsLink.name = 'sponsorsLink';			sponsorsLink.graphics.lineStyle(0, 0x000000, 0);			sponsorsLink.graphics.beginFill(0x008241, 1);			sponsorsLink.graphics.drawRect(0, 0, 118, 44);			sponsorsLink.graphics.endFill();			sponsorsLink.rotation = 8;			sponsorsLink.x = boatsLink.x + (boatsLink.width - 3);			sponsorsLink.y = 0;			sponsorsLink.alpha = 0;			skewer(sponsorsLink,-3.8,-3.8);			addChild(sponsorsLink);						sponsorsLinkTxt = new sponsorsLinkText();			sponsorsLinkTxt.name = 'sponsorsLinkTxt';			sponsorsLinkTxt.alpha = 0;			sponsorsLinkTxt.x = sponsorsLink.x - 38;			sponsorsLinkTxt.y = sponsorsLink.y + 65;			sponsorsLinkTxt.mouseEnabled = false;			sponsorsLinkTxt.visible = false;			addChild(sponsorsLinkTxt);			sponsorsLinkNumb = new sponsorsLinkNum();			sponsorsLinkNumb.name = 'sponsorsLinkNumb';			sponsorsLinkNumb.x = sponsorsLink.x + sponsorsLink.width - 46;			sponsorsLinkNumb.y = sponsorsLink.y + 18;			sponsorsLinkNumb.alpha = 0;			sponsorsLinkNumb.mouseEnabled = false;			addChild(sponsorsLinkNumb);						sponsorsLinkCover = new MovieClip();			sponsorsLinkCover.name = 'sponsors';			sponsorsLinkCover.x = boatsLink.x + (boatsLink.width - 3);			sponsorsLinkCover.y = 0;			sponsorsLinkCover.graphics.lineStyle(0, 0x000000, 0);			sponsorsLinkCover.graphics.beginFill(0x788989, 1);			sponsorsLinkCover.graphics.drawRect(0, 0, 118, 44);			sponsorsLinkCover.graphics.endFill();			sponsorsLinkCover.rotation = 8;			sponsorsLinkCover.alpha = 0;			skewer(sponsorsLinkCover,-3.8,-3.8);			sponsorsLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(sponsorsLinkCover);						//prada			pradaLink = new MovieClip();			pradaLink.name = 'pradaLink';			pradaLink.graphics.lineStyle(0, 0x000000, 0);			pradaLink.graphics.beginFill(0xEF791D, 1);			pradaLink.graphics.drawRect(0, 0, 118, 44);			pradaLink.graphics.endFill();			pradaLink.rotation = 8;			pradaLink.x = sponsorsLink.x + (sponsorsLink.width - 3);			pradaLink.y = 0;			pradaLink.alpha = 0;			skewer(pradaLink,-3.8,-3.8);			addChild(pradaLink);						pradaLinkTxt = new pradaLinkText();			pradaLinkTxt.name = 'pradaLinkTxt';			pradaLinkTxt.alpha = 0;			pradaLinkTxt.x = pradaLink.x - 77;			pradaLinkTxt.y = pradaLink.y + 65;			pradaLinkTxt.mouseEnabled = false;			pradaLinkTxt.visible = false;			addChild(pradaLinkTxt);			pradaLinkNumb = new pradaLinkNum();			pradaLinkNumb.name = 'pradaLinkNumb';			pradaLinkNumb.x = pradaLink.x + pradaLink.width - 46;			pradaLinkNumb.y = pradaLink.y + 18;			pradaLinkNumb.alpha = 0;			pradaLinkNumb.mouseEnabled = false;			addChild(pradaLinkNumb);						pradaLinkCover = new MovieClip();			pradaLinkCover.name = 'prada';			pradaLinkCover.x = sponsorsLink.x + (sponsorsLink.width - 3);			pradaLinkCover.y = 0;			pradaLinkCover.graphics.lineStyle(0, 0x000000, 0);			pradaLinkCover.graphics.beginFill(0x788989, 1);			pradaLinkCover.graphics.drawRect(0, 0, 118, 44);			pradaLinkCover.graphics.endFill();			pradaLinkCover.rotation = 8;			pradaLinkCover.alpha = 0;			skewer(pradaLinkCover,-3.8,-3.8);			pradaLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(pradaLinkCover);						//sanFran			sanFranLink = new MovieClip();			sanFranLink.name = 'sanFranLink';			sanFranLink.graphics.lineStyle(0, 0x000000, 0);			sanFranLink.graphics.beginFill(0x904F84, 1);			sanFranLink.graphics.drawRect(0, 0, 118, 44);			sanFranLink.graphics.endFill();			sanFranLink.rotation = 8;			sanFranLink.x = pradaLink.x + (pradaLink.width - 3);			sanFranLink.y = 0;			sanFranLink.alpha = 0;			skewer(sanFranLink,-3.8,-3.8);			addChild(sanFranLink);						sanFranLinkTxt = new sanFranLinkText();			sanFranLinkTxt.name = 'sanFranLinkTxt';			sanFranLinkTxt.alpha = 0;			sanFranLinkTxt.x = sanFranLink.x - 74;			sanFranLinkTxt.y = sanFranLink.y + 65;			sanFranLinkTxt.mouseEnabled = false;			sanFranLinkTxt.visible = false;			addChild(sanFranLinkTxt);			sanFranLinkNumb = new sanFranLinkNum();			sanFranLinkNumb.name = 'sanFranLinkNumb';			sanFranLinkNumb.x = sanFranLink.x + sanFranLink.width - 46;			sanFranLinkNumb.y = sanFranLink.y + 18;			sanFranLinkNumb.alpha = 0;			sanFranLinkNumb.mouseEnabled = false;			addChild(sanFranLinkNumb);						sanFranLinkCover = new MovieClip();			sanFranLinkCover.name = 'sanFran';			sanFranLinkCover.x = pradaLink.x + (pradaLink.width - 3);			sanFranLinkCover.y = 0;			sanFranLinkCover.graphics.lineStyle(0, 0x000000, 0);			sanFranLinkCover.graphics.beginFill(0x788989, 1);			sanFranLinkCover.graphics.drawRect(0, 0, 118, 44);			sanFranLinkCover.graphics.endFill();			sanFranLinkCover.rotation = 8;			sanFranLinkCover.alpha = 0;			skewer(sanFranLinkCover,-3.8,-3.8);			sanFranLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(sanFranLinkCover);						//volvo			volvoLink = new MovieClip();			volvoLink.name = 'volvoLink';			volvoLink.graphics.lineStyle(0, 0x000000, 0);			volvoLink.graphics.beginFill(0x008282, 1);			volvoLink.graphics.drawRect(0, 0, 118, 44);			volvoLink.graphics.endFill();			volvoLink.rotation = 8;			volvoLink.x = sanFranLink.x + (sanFranLink.width - 3);			volvoLink.y = 0;			volvoLink.alpha = 0;			skewer(volvoLink,-3.8,-3.8);			addChild(volvoLink);						volvoLinkTxt = new volvoLinkText();			volvoLinkTxt.name = 'volvoLinkTxt';			volvoLinkTxt.alpha = 0;			volvoLinkTxt.x = volvoLink.x - 57;			volvoLinkTxt.y = volvoLink.y + 65;			volvoLinkTxt.mouseEnabled = false;			volvoLinkTxt.visible = false;			addChild(volvoLinkTxt);			volvoLinkNumb = new volvoLinkNum();			volvoLinkNumb.name = 'volvoLinkNumb';			volvoLinkNumb.x = volvoLink.x + volvoLink.width - 46;			volvoLinkNumb.y = volvoLink.y + 18;			volvoLinkNumb.alpha = 0;			volvoLinkNumb.mouseEnabled = false;			addChild(volvoLinkNumb);						volvoLinkCover = new MovieClip();			volvoLinkCover.name = 'volvo';			volvoLinkCover.x = sanFranLink.x + (sanFranLink.width - 3);			volvoLinkCover.y = 0;			volvoLinkCover.graphics.lineStyle(0, 0x000000, 0);			volvoLinkCover.graphics.beginFill(0x788989, 1);			volvoLinkCover.graphics.drawRect(0, 0, 118, 44);			volvoLinkCover.graphics.endFill();			volvoLinkCover.rotation = 8;			volvoLinkCover.alpha = 0;			skewer(volvoLinkCover,-3.8,-3.8);			volvoLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(volvoLinkCover);						//resources			resourcesLink = new MovieClip();			resourcesLink.name = 'resourcesLink';			resourcesLink.graphics.lineStyle(0, 0x000000, 0);			resourcesLink.graphics.beginFill(0x006FA6, 1);			resourcesLink.graphics.drawRect(0, 0, 118, 44);			resourcesLink.graphics.endFill();			resourcesLink.rotation = 8;			resourcesLink.x = volvoLink.x + (volvoLink.width - 3);			resourcesLink.y = 0;			resourcesLink.alpha = 0;			skewer(resourcesLink,-3.8,-3.8);			addChild(resourcesLink);						resourcesLinkTxt = new resourcesLinkText();			resourcesLinkTxt.name = 'resourcesLinkTxt';			resourcesLinkTxt.alpha = 0;			resourcesLinkTxt.x = resourcesLink.x - 66;			resourcesLinkTxt.y = resourcesLink.y + 65;			resourcesLinkTxt.mouseEnabled = false;			resourcesLinkTxt.visible = false;			addChild(resourcesLinkTxt);			resourcesLinkNumb = new resourcesLinkNum();			resourcesLinkNumb.name = 'resourcesLinkNumb';			resourcesLinkNumb.x = resourcesLink.x + resourcesLink.width - 46;			resourcesLinkNumb.y = resourcesLink.y + 18;			resourcesLinkNumb.alpha = 0;			resourcesLinkNumb.mouseEnabled = false;			addChild(resourcesLinkNumb);						resourcesLinkCover = new MovieClip();			resourcesLinkCover.name = 'resources';			resourcesLinkCover.x = volvoLink.x + (volvoLink.width - 3);			resourcesLinkCover.y = 0;			resourcesLinkCover.graphics.lineStyle(0, 0x000000, 0);			resourcesLinkCover.graphics.beginFill(0x788989, 1);			resourcesLinkCover.graphics.drawRect(0, 0, 118, 44);			resourcesLinkCover.graphics.endFill();			resourcesLinkCover.rotation = 8;			resourcesLinkCover.alpha = 0;			skewer(resourcesLinkCover,-3.8,-3.8);			resourcesLinkCover.addEventListener(MouseEvent.ROLL_OVER,dropDown);			addChild(resourcesLinkCover);								}				//Private functions		// _x and _y are the skew in degrees		private function skewer(target:DisplayObject, _x:Number, _y:Number):void{			var mtx:Matrix = new Matrix();			mtx.b = _y * Math.PI/180;			mtx.c = _x * Math.PI/180;			mtx.concat(target.transform.matrix);			target.transform.matrix = mtx;		}		private function dropDown(e:MouseEvent):void{			e.target.removeEventListener(MouseEvent.ROLL_OVER, dropDown);			e.target.addEventListener(MouseEvent.ROLL_OUT,retract);						if(navAltered){				e.target.alpha = 0;			}						var theText:MovieClip;			theText = e.target.parent.getChildByName(e.target.name+'LinkTxt') as MovieClip;			theText.visible = true;			TweenLite.to(theText,0.5,{alpha:1, delay:0.3});						var shape:MovieClip;			shape = e.target.parent.getChildByName(e.target.name+'Link') as MovieClip;			var theHeight = (parent as appBase).theStage.stageHeight;			theHeight += 500;			TweenLite.to([e.target,shape], 0.3, {height:theHeight, width:126.95, ease:Sine.easeIn, onComplete:function(){				//trace(e.target.width);			}});					}		private function retract(e:MouseEvent):void{			e.target.removeEventListener(MouseEvent.ROLL_OUT,retract);						var theText:MovieClip;			theText = e.target.parent.getChildByName(e.target.name+'LinkTxt') as MovieClip;			TweenLite.killTweensOf(theText);			theText.alpha = 0;			theText.visible = false;						var shape:MovieClip;			shape = e.target.parent.getChildByName(e.target.name+'Link') as MovieClip;			TweenLite.fromTo([e.target,shape], 0.5, {height:710, width:23}, {height:51.85, width:126.95, onComplete:function(){				e.target.addEventListener(MouseEvent.ROLL_OVER, dropDown);				if(navAltered){					//Not current section					var pattern:RegExp = new RegExp(currSecName, "i");					var result:Object = pattern.exec(e.target.name);					if(result == null) {						e.target.alpha = 1;					}				}			}});					}				private function prepareSection(e:MouseEvent):void{			//Remove current section			var mainApp = (parent as appBase);			if(currSecName == 'home'){				var homePage = mainApp.getChildByName('home') as Sprite;				TweenLite.to(homePage,1,{alpha:0, onComplete:function(){(parent as appBase).removeChild(homePage);loadSection(e.target.name);}});				//Alter the nav				var thisY = this.y;				navYDelta = 20;				TweenLite.to(this,1,{y:thisY-navYDelta});				navAltered = true;			}else{				var thePage = mainApp.mainContainer.getChildByName(currSecName) as Sprite;				my_dispatch = new customDispatcher('finished');				my_dispatch.addEventListener(my_dispatch.ACTION,function(){					loadSection(e.target.name);					mainApp.mainContainer.removeChild(thePage);				});				thePage.flyout(my_dispatch);			}					}				private function loadSection(sectionToLoad:String):void{			if(currSecName == 'home'){				teamLinkCover.alpha = 1;				historyLinkCover.alpha = 1;				boatsLinkCover.alpha = 1;				sponsorsLinkCover.alpha = 1;				pradaLinkCover.alpha = 1;				sanFranLinkCover.alpha = 1;				volvoLinkCover.alpha = 1;				resourcesLinkCover.alpha = 1;			}else{								var currCover:MovieClip = this.getChildByName(currSecName) as MovieClip;				currCover.alpha = 1;			}			var newCover:MovieClip = this.getChildByName(sectionToLoad) as MovieClip;			newCover.alpha = 0;			//Instantiate new section			var mainApp = (parent as appBase);			switch(sectionToLoad){				case 'boats':					mainApp.secBoats = new sec_boats(mainApp);					mainApp.secBoats.name = 'boats';					mainApp.secBoats.x = 0;					mainApp.secBoats.y = 0;					mainApp.mainContainer.addChild(mainApp.secBoats);				break;				case 'team':					mainApp.secTeam = new sec_team(mainApp);					mainApp.secTeam.name = 'team';					mainApp.secTeam.x = 0;					mainApp.secTeam.y = 0;					mainApp.mainContainer.addChild(mainApp.secTeam);				break;			}			currSecName = sectionToLoad;		}				public function shaBang():void{			//Fade in all nav items			TweenLite.to([teamLink,teamLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn});			TweenLite.to([historyLink,historyLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.1});			TweenLite.to([boatsLink,boatsLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.2});			TweenLite.to([sponsorsLink,sponsorsLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.3});			TweenLite.to([pradaLink,pradaLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.4});			TweenLite.to([sanFranLink,sanFranLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.5});			TweenLite.to([volvoLink,volvoLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.6});			TweenLite.to([resourcesLink,resourcesLinkNumb], 0.5, {alpha:1, ease:Sine.easeIn, delay:0.7});		}	}	}