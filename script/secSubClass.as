package script {		import flash.geom.*	import flash.display.*;	import flash.events.*;	import flash.text.*;	import flash.media.Video;	import flash.net.NetConnection;    import flash.net.NetStream;	import flash.utils.*;	import com.greensock.*;	import com.greensock.easing.*;	import script.ui.component.ScrollBarComponent;	import component.scrollbar.ScrollBarComponentAsset;		public class secSubClass extends Sprite{				private var secSubName:String;		private var backArrCont:Sprite;		private var backArr:global_back_arr;		private var downs:global_download_story;		private var lines1:global_line;		private var lines2:global_line;		private var profileCont:Sprite;		private var storyCont:Sprite;		private var innerStoryCont:Sprite;		private var numStories:int;		private var currPage:int;		private var theDispatch:customDispatcher;		private var bigImageCont:Sprite;		private var backDrop:Sprite;		private var closeX:global_close_btn;						public function secSubClass(subName:String, my_dispatch:customDispatcher) {			// constructor code						secSubName = subName;			theDispatch = my_dispatch;			currPage = 1;						//sec1.team_stories.container;						backArr = new global_back_arr();			backArr.name = 'backArr';			backArr.x = 20 - (backArr.width/2);			backArr.y = 20;			backArrCont = new Sprite();			backArrCont.name = 'backArrCont';			backArrCont.x = 30;			backArrCont.y = 0;			backArrCont.buttonMode = true;			addChild(backArrCont);						storyCont = new Sprite();			storyCont.name ='storyCont';						//lines			lines1 = new global_line();			lines1.name = 'lines1';			lines1.x = 30;			lines1.y = 112;						addChild(lines1);						//Set up the switch statement			var switchIdentifier:String = '';			var pattern:RegExp = /_profile/; 			var res = secSubName.search(pattern);			if(res > -1){				switchIdentifier = 'profile';			}else{				switchIdentifier = secSubName;			}						switch(switchIdentifier){//secSubName				/**				* Boat section				*/				case 'sec_3_sub_1':					//Close					giveMeABackBtn('sec_3_sub_1_back', 0x008298, 0x005462);					//Download					giveMeADownloadBtn();					//Title					var thisTitle:sec_3_the_boats_title = new sec_3_the_boats_title();					thisTitle.name = 'theBoats';					thisTitle.x = 30;					thisTitle.y = 55;					addChild(thisTitle);										addChild(storyCont);					innerStoryCont = new Sprite();					storyCont.addChild(innerStoryCont);					//Story - page 1					var thisStory1:sec_3_the_boats_story_1 = new sec_3_the_boats_story_1();					thisStory1.name ='thisStory1';					thisStory1.x = 30;					thisStory1.y = 132;					innerStoryCont.addChild(thisStory1);										//Story - page 2					var thisStory2:sec_3_the_boats_story_2 = new sec_3_the_boats_story_2();					thisStory2.name ='thisStory2';					thisStory2.x = 1300;					thisStory2.y = 132;					innerStoryCont.addChild(thisStory2);										lines2 = new global_line();					lines2.name = 'lines2';					lines2.x = 30;					lines2.y = 515;					addChild(lines2);										//Next Prev					numStories = 2;					giveMeSomeNextPrev('sec_3',1);									break;				case 'boat_img_gal':					//Close					giveMeABackBtn('sec_3_img_gal_back', 0x008298, 0x005462);					//Title					var thisTitle_imgGal:sec_3_img_gal_title = new sec_3_img_gal_title();					thisTitle_imgGal.name = 'thisTitle_imgGal';					thisTitle_imgGal.x = 20;					thisTitle_imgGal.y = 55;					addChild(thisTitle_imgGal);										addChild(storyCont);										//Img gallery					//Describe the images for this gall										var boatThumb1:sec_3_thumb_1 = new sec_3_thumb_1();					var boatThumb2:sec_3_thumb_2 = new sec_3_thumb_2();					var boatThumb3:sec_3_thumb_3 = new sec_3_thumb_3();					var imgArr:Array = new Array(boatThumb1,boatThumb2,boatThumb3);					/*****					***** May have to supply an array of names as a a string to find the class definition - in the case where one image is shared between mny galleries					*****/					var sec_3_img_gal:image_gallery = new image_gallery(imgArr,'sec_3_image_',0x008298, 0x005462);					sec_3_img_gal.name = 'sec_3_img_gal';					sec_3_img_gal.x = 30;					storyCont.addChild(sec_3_img_gal);									break;								/**				* People profiles				*/				case 'profile':					//Identify those with stories and how many pages are in each					var storyArr:Array = new Array();					storyArr[0] = new Array();					storyArr[0][0] = 'c_mcasey';					storyArr[0][1] = 1;					storyArr[1] = new Array();					storyArr[1][0] = 'd_saward';					storyArr[1][1] = 1;					storyArr[2] = new Array();					storyArr[2][0] = 'g_ashby';					storyArr[2][1] = 2;					storyArr[3] = new Array();					storyArr[3][0] = 'j_dagg';					storyArr[3][1] = 2;					storyArr[4] = new Array();					storyArr[4][0] = 'r_davies';					storyArr[4][1] = 3;					storyArr[5] = new Array();					storyArr[5][0] = 'r_meacham';					storyArr[5][1] = 2;					storyArr[6] = new Array();					storyArr[6][0] = 'r_waddell';					storyArr[6][1] = 2;									var nameBit:String = tools.getNameBit(secSubName);					//Close					giveMeABackBtn(nameBit+'_back', 0xC6A43D, 0x8E6F32);					//Profile					profileCont = new Sprite();					profileCont.name = 'profileCont';					addChild(profileCont);					//Title					var classRef1:Class = getDefinitionByName(nameBit+'_profile_title') as Class;					var title_person_prof:MovieClip = new classRef1();					title_person_prof.name = nameBit+'_title';					title_person_prof.x = 30;					title_person_prof.y = 55;					profileCont.addChild(title_person_prof);					//Download profile btn					var profile_download:global_download_profile = new global_download_profile();					profile_download.name = nameBit+'_profile_download';					profile_download.x = 875;					profile_download.y = 55;					profile_download.buttonMode = true;					profile_download.addEventListener(MouseEvent.ROLL_OVER, appBase.rollOn);					profile_download.addEventListener(MouseEvent.ROLL_OUT, appBase.rollOff);					profile_download.addEventListener(MouseEvent.MOUSE_DOWN, function(){trace('need to code this');});					profileCont.addChild(profile_download);										//Profile img					var classRef4:Class = getDefinitionByName(nameBit+'_prof_img') as Class;					var profileImg:MovieClip = new classRef4();					profileImg.name = nameBit+'_profileImg';					profileImg.x = 30;					profileImg.y = 170;					profileCont.addChild(profileImg);					//Check for details txt					var detailsArr:Array = new Array('a_beashel','c_mcasey','c_ward','d_seward','j_dagg','j_lomas','r_davies','r_meacham','r_waddell','t_rae','w_macfalane');					var isPresent:Boolean = detailsArr.some(function(element:*, index:int, arr:Array){						 return (nameBit == element);					});					if(isPresent){						var classRef9:Class = getDefinitionByName(nameBit+'_details') as Class;						var profileDetails:MovieClip = new classRef9();						profileDetails.name = nameBit+'_profileDetails';						profileDetails.x = 30;						profileDetails.y = profileImg.y + profileImg.height + 8;						profileCont.addChild(profileDetails);					}					//Profile text					var classRef5:Class = getDefinitionByName(nameBit+'_prof_txt') as Class;					var profileTxt:MovieClip = new classRef5();					profileTxt.name = nameBit+'_profileTxt';					profileTxt.x = profileImg.x + profileImg.width + 15;					profileTxt.y = 170;					profileCont.addChild(profileTxt);					//Scrollbar					var sbComponent:ScrollBarComponent = new ScrollBarComponent(new ScrollBarComponentAsset());					sbComponent.init(profileTxt, 322, 322);					sbComponent.content.x = (profileTxt.x + profileTxt.width) + 5;					sbComponent.content.y = 170;					//sbComponent.enable();					profileCont.addChild(sbComponent.content);					//Check for images					var imgArrThumbs:Array = new Array('c_mcasey','d_barker','d_saward','g_ashby','g_dalton','g_loretz','j_dagg','j_lomas','m_nora','r_davies','r_meacham','r_waddell','w_macfalane');					var imgArrThumbsHit:int = 0;					var isPresent2:Boolean = imgArrThumbs.some(function(element:*, index:int, arr:Array){						 if(nameBit == element){							imgArrThumbsHit = index;							return true;						 }else{							 return false;						 }					});					if(isPresent2){						var theThumbList:Array = tools.getThumbList();												//Number of images						var numberThumbs = theThumbList[imgArrThumbsHit].length;						numberThumbs = numberThumbs - 1;												for(var j:int = 0; j < numberThumbs; j ++){							var intExtension:int = j+1;							var classRef10:Class = getDefinitionByName('sec_1_'+nameBit+'_profile_thumb_'+intExtension) as Class;							var profileThumb:MovieClip = new classRef10();							profileThumb.name = 'sec_1_'+nameBit+'_profile_img_'+intExtension;							profileThumb.x = theThumbList[imgArrThumbsHit][intExtension][0];							profileThumb.y = theThumbList[imgArrThumbsHit][intExtension][1];							profileThumb.buttonMode = true;							profileThumb.addEventListener(MouseEvent.MOUSE_DOWN, openBig);							profileCont.addChild(profileThumb);						}											}										var aStory:Boolean = false;					var arrHit:int = 0;					for(var i:int = 0; i < storyArr.length; i ++){												var res1 = storyArr[i][0].search(nameBit);						if(res1 > -1){							aStory = true;							arrHit = i;						}					}					if(aStory){						var classRef2:Class = getDefinitionByName('sec_1_'+nameBit+'_profile_button') as Class;						var profileBtn:MovieClip = new classRef2();						profileBtn.name = nameBit+'_profileBtn';						profileBtn.x = 30;						profileBtn.y = 119;						profileBtn.buttonMode = true;						profileBtn.addEventListener(MouseEvent.ROLL_OVER, appBase.rollOn);						profileBtn.addEventListener(MouseEvent.ROLL_OUT, appBase.rollOff);						profileBtn.addEventListener(MouseEvent.MOUSE_DOWN, hideMyStory);						addChild(profileBtn);						//						var classRef3:Class = getDefinitionByName('sec_1_'+nameBit+'_story_button') as Class;						var storyBtn:MovieClip = new classRef3();						storyBtn.name = nameBit+'_storyBtn';						storyBtn.x = profileBtn.x + profileBtn.width + 10;						storyBtn.y = 119;						storyBtn.buttonMode = true;						storyBtn.addEventListener(MouseEvent.ROLL_OVER, appBase.rollOn);						storyBtn.addEventListener(MouseEvent.ROLL_OUT, appBase.rollOff);						storyBtn.addEventListener(MouseEvent.MOUSE_DOWN, showMyStory);						addChild(storyBtn);						//						var greyLine:global_line_grey = new global_line_grey();						greyLine.x = 30;						greyLine.y = 120 + storyBtn.height + 5;						addChild(greyLine);												storyCont.alpha = 0;						storyCont.visible = false;						addChild(storyCont);						//Set up an inner container to handle tweening just the text						innerStoryCont = new Sprite();						storyCont.addChild(innerStoryCont);						//title						//Good old mr davies is the only exeption!!						if(nameBit != 'r_davies'){							var classRef6:Class = getDefinitionByName('sec1.team_stories.sec_1_'+nameBit+'_story_title') as Class;							var storyTitle:MovieClip = new classRef6();							storyTitle.name = nameBit+'_storyTitle';							storyTitle.x = 30;							storyTitle.y = 55;							storyCont.addChild(storyTitle);						}else{							var classRefDavies1:Class = getDefinitionByName('sec1.team_stories.sec_1_'+nameBit+'_story_title_1') as Class;							var storyTitle1:MovieClip = new classRefDavies1();							storyTitle1.name = nameBit+'_storyTitle_1';							storyTitle1.x = 30;							storyTitle1.y = 55;							innerStoryCont.addChild(storyTitle1);							var classRefDavies2:Class = getDefinitionByName('sec1.team_stories.sec_1_'+nameBit+'_story_title_2') as Class;							var storyTitle2:MovieClip = new classRefDavies2();							storyTitle2.name = nameBit+'_storyTitle_2';							storyTitle2.x = 1300;							storyTitle2.y = 55;							innerStoryCont.addChild(storyTitle2);						}												//First page						var classRef7:Class = getDefinitionByName('sec1.team_stories.sec_1_'+nameBit+'_story_1') as Class;						var storyPage1:MovieClip = new classRef7();						storyPage1.name = nameBit+'_storyPage1';						storyPage1.x = 30;						storyPage1.y = 170;						innerStoryCont.addChild(storyPage1);						//Check for more pages						numStories = storyArr[arrHit][1];						if(numStories > 1){							for(var k:int = 2; k <= numStories; k ++){								var classRef8:Class = getDefinitionByName('sec1.team_stories.sec_1_'+nameBit+'_story_'+k) as Class;								var storyPage2:MovieClip = new classRef8();								storyPage2.name = nameBit+'_storyPage'+k;								storyPage2.x = 1300 * (k - 1);								storyPage2.y = 170;								innerStoryCont.addChild(storyPage2);								}														//Next Prev							giveMeSomeNextPrev('sec_1',0);						}											}										lines2 = new global_line();					lines2.name = 'lines2';					lines2.x = 30;					lines2.y = 515;					addChild(lines2);									break;			}		}				/**		* Public functions		*/				public function openBig(e:MouseEvent):void{						//trace(e.currentTarget.name);						bigImageCont = new Sprite();			bigImageCont.alpha = 0;						backDrop = new Sprite();			backDrop.name ='backDrop';			backDrop.x = 0;			backDrop.y = 0;			backDrop.graphics.beginFill(0x000000, 0.7);			backDrop.graphics.drawRect(0, 0, 1024, 576);			backDrop.graphics.endFill();			backDrop.width = 1024;			backDrop.height = 576;			bigImageCont.addChild(backDrop);						var classRefOpenBig:Class = getDefinitionByName(e.currentTarget.name) as Class;			var bigImage:MovieClip = new classRefOpenBig();			bigImage.name = 'bigImage';			bigImage.x = 512 - (bigImage.width / 2);			bigImage.y = 0;			bigImageCont.addChild(bigImage);						var closeCont:Sprite = new Sprite();			closeCont.name = 'closeCont';			closeCont.x = 30;			closeCont.y = 0;			closeCont.buttonMode = true;			bigImageCont.addChild(closeCont);			var thisBack:Sprite = new Sprite();			thisBack.name = 'thisBack';						thisBack.graphics.beginFill(0xD4A630, 1);			thisBack.graphics.drawRect(0, 0, 40, 40);			thisBack.graphics.endFill();			thisBack.width = 40;			thisBack.height = 40;			thisBack.x = 0;			thisBack.y = 0;			closeX = new global_close_btn();			closeX.x = 22 - (closeX.width/2);			closeX.y = 22 - (closeX.height/2);			closeCont.addChild(thisBack);			closeCont.addChild(closeX);			closeCont.addEventListener(MouseEvent.ROLL_OVER, function(){				//alter colour 				var my_color:ColorTransform = new ColorTransform();				my_color.color = 0x8E6F32;				thisBack.transform.colorTransform = my_color;			});			closeCont.addEventListener(MouseEvent.ROLL_OUT, function(){				//alter colour				var my_color:ColorTransform = new ColorTransform();				my_color.color = 0xD4A630;				thisBack.transform.colorTransform = my_color;			});			closeCont.addEventListener(MouseEvent.MOUSE_DOWN, closeImgDown);						//Add in download button			/*			var downBtn:global_download_image = new global_download_image();			downBtn.name = 'downBtn';			downBtn.x = 512 - (downBtn.width / 2);			downBtn.y = 538;			downBtn.buttonMode = true;			downBtn.addEventListener(MouseEvent.MOUSE_DOWN, downloadThis);			bigImageCont.addChild(downBtn);						//Next/Prev			giveMeSomeNextPrev(bigImageCont);			*/						addChild(bigImageCont);			TweenLite.to(bigImageCont, 0.5, {alpha:1});					}				/**		* Close the large image		*/		public function closeImgDown(e:MouseEvent):void{			TweenLite.to(bigImageCont, 0.5, {alpha:0, ease:Sine.easeOut, onComplete:function(){				removeChild(bigImageCont); 			}});		}				/**		* Show the story container that sits over the profile		*/		public function showMyStory(e:MouseEvent):void{			TweenLite.to(profileCont, 0.5, {alpha:0, ease:Sine.easeIn, onComplete:function(){				profileCont.visible = false;				storyCont.visible = true;				var theNext = getChildByName('nextBtn') as MovieClip;				if(currPage < numStories){					theNext.visible = true;				}				var thePrev = getChildByName('prevBtn') as MovieClip;				if(currPage > 1){					thePrev.visible = true;				}				TweenLite.to([theNext,thePrev,storyCont], 0.5, {alpha:1, ease:Sine.easeIn});			}});		}				/**		* Hide the story container that sits over the profile		*/		public function hideMyStory(e:MouseEvent):void{			if(numStories > 1){				var theNext = getChildByName('nextBtn') as MovieClip;				var thePrev = getChildByName('prevBtn') as MovieClip;			}			TweenLite.to([theNext,thePrev,storyCont], 0.5, {alpha:0, ease:Sine.easeIn, onComplete:function(){				profileCont.visible = true;				storyCont.visible = false;				if(numStories > 1){					theNext.visible = false;									thePrev.visible = false;				}				TweenLite.to(profileCont, 0.5, {alpha:1, ease:Sine.easeIn});			}});		}				public function closeMeDown(e:MouseEvent):void{			theDispatch.dispatchEvent(new Event(theDispatch.ACTION));		}				public function downloadThisStory(e:MouseEvent):void{			trace('need to build this');		}				public function giveMeABackBtn(theName:String, theColour1:uint, theColour2:uint):void{			var thisBack:Sprite = new Sprite();			thisBack.name = theName;			thisBack.graphics.beginFill(theColour1, 1);			thisBack.graphics.drawRect(0, 0, 40, 40);			thisBack.graphics.endFill();			thisBack.width = 40;			thisBack.height = 40;			backArrCont.addChild(thisBack);			backArrCont.addChild(backArr);			backArrCont.addEventListener(MouseEvent.ROLL_OVER, function(){				//alter colour 				var my_color:ColorTransform = new ColorTransform();				my_color.color = theColour2;				thisBack.transform.colorTransform = my_color;			});			backArrCont.addEventListener(MouseEvent.ROLL_OUT, function(){				//alter colour				var my_color:ColorTransform = new ColorTransform();				my_color.color = theColour1;				thisBack.transform.colorTransform = my_color;			});			backArrCont.addEventListener(MouseEvent.MOUSE_DOWN, closeMeDown);		}				public function giveMeADownloadBtn():void{			downs = new global_download_story();			downs.name 'downs';			downs.x = 854;			downs.y = 62;			downs.buttonMode = true;			downs.addEventListener(MouseEvent.MOUSE_DOWN, downloadThisStory);			addChild(downs);		}				public function giveMeSomeNextPrev(section:String, opacity:int):void{						var classRef1:Class = getDefinitionByName(section+'_previous_page') as Class;			var prevBtn:MovieClip = new classRef1();						prevBtn.name ='prevBtn';			prevBtn.x = 392;			prevBtn.y = 538;			prevBtn.alpha = opacity;			prevBtn.buttonMode = true;			if(currPage <= 1 || opacity == 0){				prevBtn.visible = false;			}			prevBtn.addEventListener(MouseEvent.MOUSE_DOWN, moveThisPageYo);						prevBtn.addEventListener(MouseEvent.ROLL_OVER, appBase.rollOn);			prevBtn.addEventListener(MouseEvent.ROLL_OUT, appBase.rollOff);			addChild(prevBtn);						var classRef2:Class = getDefinitionByName(section+'_next_page') as Class;			var nextBtn:MovieClip = new classRef2();						nextBtn.name ='nextBtn';			nextBtn.x = 517;			nextBtn.y = 538;			nextBtn.alpha = opacity;			if(opacity == 0){				nextBtn.visible = false;			}			nextBtn.buttonMode = true;			nextBtn.addEventListener(MouseEvent.MOUSE_DOWN, moveThisPageYo);			nextBtn.addEventListener(MouseEvent.ROLL_OVER, appBase.rollOn);			nextBtn.addEventListener(MouseEvent.ROLL_OUT, appBase.rollOff);			addChild(nextBtn);		}				public function moveThisPageYo(e:MouseEvent):void{			var nextBtn:MovieClip = getChildByName('nextBtn') as MovieClip;			var prevBtn:MovieClip = getChildByName('prevBtn') as MovieClip;						switch(e.currentTarget.name){				case 'nextBtn':					if(currPage < numStories){						var currPos:int = innerStoryCont.x;						TweenLite.to(innerStoryCont,1,{x:currPos-1270, ease:Sine.easeOut, onComplete:function(){							currPage ++;							//REmove next btn							if(currPage >= numStories){								nextBtn.visible = false;							}							if(currPage > 1){								prevBtn.visible = true;							}						}});					}				break;				case 'prevBtn':					if(currPage > 1){						var currPos1:int = innerStoryCont.x;						TweenLite.to(innerStoryCont,1,{x:currPos1+1270, ease:Sine.easeOut, onComplete:function(){							currPage --;							if(currPage <= 1){								prevBtn.visible = false;							}							if(currPage < numStories){								nextBtn.visible = true;							}						}});						//REmove prev btn					}				break;			}		}		}	}